var apiKey="ybHBduA57s39icEEjF2qadz3AtlfLgn9sn6AjddB";function loadMap(lat,lon){L.mapquest.key="0tfYPkeZd3BGwgIqYGALw5AGWEC1jlLf";var container=L.DomUtil.get("map");null!=container&&(container._leaflet_id=null);var baseLayer=L.mapquest.tileLayer("map"),map=L.mapquest.map("map",{center:[lat,lon],layers:baseLayer,zoom:10});L.control.layers({Map:baseLayer,Hybrid:L.mapquest.tileLayer("hybrid"),Satellite:L.mapquest.tileLayer("satellite"),Light:L.mapquest.tileLayer("light"),Dark:L.mapquest.tileLayer("dark")}).addTo(map)}function pickState(state){var queryURL="https://developer.nps.gov/api/v1/parks?stateCode="+state+"&api_key="+apiKey;$.ajax({url:queryURL,method:"GET"}).then((function(response){for($("#state-list").empty(),console.log(response),i=0;i<response.data.length;i++)statebutton=$("<button>"),statebutton.attr("data-state",i),statebutton.attr("class","park-list btn"),statebutton.text(response.data[i].fullName),$("#state-list").append(statebutton);function loadstateInfo(stateInfo){$("#state-activities").empty(),$("#state-link").empty(),$("#state-pics").empty(),$("#directions").empty(),$("#park-description").text(response.data[stateInfo].description);let statePics=response.data[stateInfo].images;var slider=$("#park-carousel");if(slider.carousel(),statePics.length>0)for($("#park-carousel").empty(),$("#pic1").remove(),i=0;i<statePics.length;i++)slider.append('<a class="carousel-item" href="#'+i+'!"><img src="'+statePics[i].url+'"></a>');else $("#park-carousel").empty(),$("#park-carousel").append('<a class="carousel-item" href="#one!" id="pic1"><img src=""></a>',"<p>No available pictures for display, please visit Park page for more information.</p>");slider.hasClass("initialized")&&slider.removeClass("initialized"),slider.carousel();let stateActivities=response.data[stateInfo].activities;if(0==stateActivities.length)$("#state-activities").text("No activities available for this park, please visit their page for more information.");else if(stateActivities.length>0)for(i=0;i<stateActivities.length;i++){let activityButton="<div class='col activity-list'>"+response.data[stateInfo].activities[i].name+"</div>";$("#state-activities").append(activityButton)}let parkLink=$("<a>");if(parkLink.attr("class","btn"),parkLink.attr("href",response.data[stateInfo].url),parkLink.text("Visit Park Page"),$("#state-link").append(parkLink),0==response.data[stateInfo].directionsInfo){let dirText=$("<p>");dirText.text("Contact park for directions.");let dirLink=$("<a>");dirLink.attr("class","btn"),dirLink.attr("href",response.data[stateInfo].url),dirLink.text("Visit Park Page"),$("#directions").append(dirText,dirLink)}else{let dirText=$("<p>");dirText.text(response.data[stateInfo].directionsInfo);let dirLink=$("<a>");dirLink.attr("class","btn"),dirLink.attr("href",response.data[stateInfo].directionsUrl),dirLink.text("Get Directions"),$("#directions").append(dirText,dirLink)}}if($(document).on("click",".park-list",(function(){let stateInfo=$(this).attr("data-state");loadstateInfo(stateInfo);let lat=response.data[stateInfo].latitude,lon=response.data[stateInfo].longitude;loadMap(lat,lon);let latlon={lat:lat,lon:lon};localStorage.setItem("savedLatLon",JSON.stringify(latlon)),localStorage.setItem("saveStateInfo",JSON.stringify(stateInfo))})),null!==localStorage.getItem("saveStateInfo")){let newStateInfo=JSON.parse(localStorage.getItem("saveStateInfo")),newLatLon=JSON.parse(localStorage.getItem("savedLatLon"));loadstateInfo(newStateInfo),loadMap(newLatLon.lat,newLatLon.lon)}else{let newStateInfo=[Math.floor(Math.random()*response.data.length)],lat=response.data[newStateInfo].latitude,lon=response.data[newStateInfo].longitude;loadstateInfo(newStateInfo),loadMap(lat,lon)}}))}function loadsavedState(){if(null!==localStorage.getItem("savedState")){let state;pickState(JSON.parse(localStorage.getItem("savedState")))}else{let state;pickState("fl")}}loadsavedState(),M.AutoInit(),$(document).ready((function(){$(".modal").modal()})),$("#state").on("change",(function(){let state=$(this).val();pickState(state),localStorage.setItem("savedState",JSON.stringify(state))}));